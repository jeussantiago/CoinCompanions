{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jeussantiago/Documents/coding/django/CoinCompanions/backend/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jeussantiago/Documents/coding/django/CoinCompanions/backend/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jeussantiago/Documents/coding/django/CoinCompanions/backend/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{Modal,Button,FormControl,ListGroup}from\"react-bootstrap\";import{useDispatch,useSelector}from\"react-redux\";import axios from\"axios\";import\"../../styles/screens/FriendsScreen.css\";import{getUserFriendSearch}from\"../../actions/userActions\";import AlertMessage from\"../AlertMessage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function SearchFriendPopup(_ref){var show=_ref.show,onClose=_ref.onClose;var dispatch=useDispatch();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),searchTerm=_useState2[0],setSearchTerm=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showAlert=_useState4[0],setShowAlert=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),alertMessage=_useState6[0],setAlertMessage=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),alertVariant=_useState8[0],setAlertVariant=_useState8[1];var _useState9=useState(null||Boolean),_useState10=_slicedToArray(_useState9,2),friendRequestSent=_useState10[0],setFriendRequestSent=_useState10[1];var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var userFriendSearchResults=useSelector(function(state){return state.userFriendSearch;});var userFriendSearch=userFriendSearchResults.userFriendSearch;var handleClose=function handleClose(){setSearchTerm(\"\");onClose();};var handleSearchChange=function handleSearchChange(e){setSearchTerm(e.target.value);};var handleSendFriendRequest=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(id){var config,response,err_message;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;config={headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(userInfo.token)}};_context.next=4;return axios.post(\"/api/users/friend-requests/send/\".concat(id,\"/\"),{},config);case 4:response=_context.sent;// console.log(response.status);\nif(response.status===201){// If the request was successful, return \"success\"\nhandleShowAlert(\"Friend request sent successfully!\",\"success\");}else{handleShowAlert(\"An error occurred. Please try again.\",\"danger\");}setFriendRequestSent(true);_context.next=14;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);err_message=_context.t0.response&&_context.t0.response.data.detail?_context.t0.response.data.detail:_context.t0.message;handleShowAlert(err_message,\"danger\");setFriendRequestSent(true);case 14:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return function handleSendFriendRequest(_x){return _ref2.apply(this,arguments);};}();var handleShowAlert=function handleShowAlert(message,variant){setAlertMessage(message);setAlertVariant(variant);setShowAlert(true);setTimeout(function(){setShowAlert(false);},3000);// Hide the alert after 3 seconds\n};useEffect(function(){dispatch(getUserFriendSearch(searchTerm));setFriendRequestSent(null);},[dispatch,searchTerm,friendRequestSent]);return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onClose,children:[/*#__PURE__*/_jsx(Modal.Header,{children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Search Users\"})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsx(FormControl,{type:\"text\",placeholder:\"Search...\",value:searchTerm,onChange:handleSearchChange,className:\"mb-3\"}),/*#__PURE__*/_jsx(ListGroup,{className:\"search-results-container\",children:userFriendSearch&&userFriendSearch.map(function(friend){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row justify-content-between\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center\",children:friend.email}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return handleSendFriendRequest(friend.id);},children:\"Send friend request\"})]})},friend.id);})})]}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"})}),showAlert&&/*#__PURE__*/_jsx(AlertMessage,{message:alertMessage,variant:alertVariant})]});}export default SearchFriendPopup;","map":{"version":3,"names":["React","useEffect","useState","Modal","Button","FormControl","ListGroup","useDispatch","useSelector","axios","getUserFriendSearch","AlertMessage","jsx","_jsx","jsxs","_jsxs","SearchFriendPopup","_ref","show","onClose","dispatch","_useState","_useState2","_slicedToArray","searchTerm","setSearchTerm","_useState3","_useState4","showAlert","setShowAlert","_useState5","_useState6","alertMessage","setAlertMessage","_useState7","_useState8","alertVariant","setAlertVariant","_useState9","Boolean","_useState10","friendRequestSent","setFriendRequestSent","userLogin","state","userInfo","userFriendSearchResults","userFriendSearch","handleClose","handleSearchChange","e","target","value","handleSendFriendRequest","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","id","config","response","err_message","wrap","_callee$","_context","prev","next","headers","Authorization","concat","token","post","sent","status","handleShowAlert","t0","data","detail","message","stop","_x","apply","arguments","variant","setTimeout","onHide","children","Header","Title","Body","type","placeholder","onChange","className","map","friend","Item","email","onClick","Footer"],"sources":["/Users/jeussantiago/Documents/coding/django/CoinCompanions/backend/frontend/src/components/FriendsScreenComponents/SearchFriendPopup.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Modal, Button, FormControl, ListGroup } from \"react-bootstrap\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport axios from \"axios\";\n\nimport \"../../styles/screens/FriendsScreen.css\";\nimport { getUserFriendSearch } from \"../../actions/userActions\";\nimport AlertMessage from \"../AlertMessage\";\n\nfunction SearchFriendPopup({ show, onClose }) {\n    const dispatch = useDispatch();\n    const [searchTerm, setSearchTerm] = useState(\"\");\n    const [showAlert, setShowAlert] = useState(false);\n    const [alertMessage, setAlertMessage] = useState(\"\");\n    const [alertVariant, setAlertVariant] = useState(\"\");\n    const [friendRequestSent, setFriendRequestSent] = useState(null || Boolean);\n\n    const userLogin = useSelector((state) => state.userLogin);\n    const { userInfo } = userLogin;\n\n    const userFriendSearchResults = useSelector(\n        (state) => state.userFriendSearch\n    );\n    const { userFriendSearch } = userFriendSearchResults;\n\n    const handleClose = () => {\n        setSearchTerm(\"\");\n        onClose();\n    };\n\n    const handleSearchChange = (e) => {\n        setSearchTerm(e.target.value);\n    };\n\n    const handleSendFriendRequest = async (id) => {\n        try {\n            const config = {\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    Authorization: `Bearer ${userInfo.token}`,\n                },\n            };\n            const response = await axios.post(\n                `/api/users/friend-requests/send/${id}/`,\n                {},\n                config\n            );\n            // console.log(response.status);\n            if (response.status === 201) {\n                // If the request was successful, return \"success\"\n                handleShowAlert(\"Friend request sent successfully!\", \"success\");\n            } else {\n                handleShowAlert(\n                    \"An error occurred. Please try again.\",\n                    \"danger\"\n                );\n            }\n            setFriendRequestSent(true);\n        } catch (err) {\n            const err_message =\n                err.response && err.response.data.detail\n                    ? err.response.data.detail\n                    : err.message;\n            handleShowAlert(err_message, \"danger\");\n            setFriendRequestSent(true);\n        }\n    };\n\n    const handleShowAlert = (message, variant) => {\n        setAlertMessage(message);\n        setAlertVariant(variant);\n        setShowAlert(true);\n        setTimeout(() => {\n            setShowAlert(false);\n        }, 3000); // Hide the alert after 3 seconds\n    };\n\n    useEffect(() => {\n        dispatch(getUserFriendSearch(searchTerm));\n        setFriendRequestSent(null);\n    }, [dispatch, searchTerm, friendRequestSent]);\n\n    return (\n        <Modal show={show} onHide={onClose}>\n            <Modal.Header>\n                <Modal.Title>Search Users</Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n                <FormControl\n                    type=\"text\"\n                    placeholder=\"Search...\"\n                    value={searchTerm}\n                    onChange={handleSearchChange}\n                    className=\"mb-3\"\n                />\n                <ListGroup className=\"search-results-container\">\n                    {userFriendSearch &&\n                        userFriendSearch.map((friend) => (\n                            <ListGroup.Item key={friend.id}>\n                                <div className=\"d-flex flex-row justify-content-between\">\n                                    <div className=\"d-flex align-items-center\">\n                                        {friend.email}\n                                    </div>\n                                    <Button\n                                        onClick={() =>\n                                            handleSendFriendRequest(friend.id)\n                                        }\n                                    >\n                                        Send friend request\n                                    </Button>\n                                </div>\n                            </ListGroup.Item>\n                        ))}\n                </ListGroup>\n            </Modal.Body>\n            <Modal.Footer>\n                <Button variant=\"secondary\" onClick={handleClose}>\n                    Close\n                </Button>\n            </Modal.Footer>\n            {showAlert && (\n                <AlertMessage message={alertMessage} variant={alertVariant} />\n            )}\n        </Modal>\n    );\n}\n\nexport default SearchFriendPopup;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}